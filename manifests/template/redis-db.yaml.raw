# This file was generated by running 'make template/redis-db.yaml.raw' in manifests directory
apiVersion: templating.flanksource.com/v1
kind: Template
metadata:
  name: redis-db
spec:
  resources:
  - apiVersion: databases.spotahome.com/v1
    kind: RedisFailover
    metadata:
      name: '{{.metadata.name}}'
      namespace: '{{.metadata.namespace}}'
    spec:
      redis:
        replicas: '{{.spec.redis.replicas | default "3"}}'
        resources:
          limits:
            cpu: '{{.spec.redis.resources.limits.cpu | default "100m"}}'
            memory: '{{.spec.redis.resources.limits.memory | default "500Mi"}}'
          requests:
            cpu: '{{.spec.redis.resources.requests.cpu | default "100m"}}'
            memory: '{{.spec.redis.resources.requests.memory | default "500Mi"}}'
        storage:
          persistentVolumeClaim:
            metadata:
              name: '{{.metadata.name}}-persistent-data'
            spec:
              accessModes:
              - ReadWriteOnce
              resources:
                requests:
                  storage: '{{.spec.storage.size | default "1Gi"}}'
              storageClassName: '{{.spec.storage.storageClass | default ""}}'
      sentinel:
        replicas: '{{.spec.sentinel.replicas | default "3"}}'
        resources:
          limits:
            cpu: '{{.spec.sentinel.resources.limits.cpu | default "100m"}}'
            memory: '{{.spec.sentinel.resources.limits.memory | default "100Mi"}}'
          requests:
            cpu: '{{.spec.sentinel.resources.requests.cpu | default "100m"}}'
            memory: '{{.spec.sentinel.resources.requests.memory | default "100Mi"}}'
  source:
    apiVersion: db.flanksource.com/v1
    kind: RedisDB